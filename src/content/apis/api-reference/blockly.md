---
title: Blockly
layout: apis.hbs
columns: two
order: 3
---

# {{title}}

## Introduction

[Blockly](https://developers.google.com/blockly/guides/overview) is a code editor developed by Google. Programming logics and functions are represented in an easy to understand graphical blocks. Misty has developed our own blockly editor application running on web browser.

## GUI

The following section describes the command menu on the Misty blockly editor.

![Blockly menu](../../../assets/images/menu_blockly_1.png)

* **Enter Robot IP Address**: user input for Misty robot IP address to communicate to
* **Connection Status**: status indication whether blockly is able to successfully communicate to the robot (green means success and red means failure)
* **Status**: corresponding status message
* **Run**: run blockly blocks on the workspace
* **Abort**: abort currently running blocks
* **Show JavaScript Code**: display underlying JavaScript code generated by blockly
* **Save blockly**: save current blocks on workspace as blockly.txt to ~/Downloads folder
* **Open blockly**: open saved blockly file onto the workspace
* **Enable Locomotion**: enable/disable locomotion blocks on the workspace.  This is useful when you are testing a sequence of blocks and want to skip the blocks that would make the robot move (ex off the table).

## API

The following section describes Misty specific Blockly blocks along with their underlying HTTP requests and JSON payload.

### Locomotion

### Move ###
Move robot forward or backward at a certain speed for a duration (in millisecond)

![Move](../../../assets/images/move.png)

Parameters
* Direction: forward or backward
* Speed: value from 0 to 10
* Duration: in millisecond with 100 ms increment with maximum value of 10 second
~~~json
{   type: "perform_locomotion",
    payload: "{"linear":2,"angular":0,"duration":"500"}"
}
~~~

### Turn ###
Turn robot left or right at a certain speed for a duration (in millisecond)

![Turn](../../../assets/images/turn.png)

Parameters
* Direction: left or right
* Speed: value from 0 to 5
* Duration: in millisecond with 100 ms increment with maximum value of 10 second
~~~json
{   type: "perform_locomotion",
    payload: "{"linear":0,"angular":2,"degree":45,"duration":"500"}"
}
~~~

### Pause ###
Pause robot for a duration (in millisecond)

![Pause](../../../assets/images/pause.png)

Parameters
* Duration: in millisecond with 100 ms increment with maximum value of 10 second
~~~json
{   type: "perform_locomotion",
    payload: "{"linear":0,"angular":0,"duration":"500"}"
}
~~~

### Arm ###
Move robot left or right arm to position up or down at a certain speed

![Arm](../../../assets/images/arm.png)

Parameters
* Arm: left or right
* Position: range value from 0 (up) to 10 (down)
* Speed: value from 0 to 10
~~~json
{   type: "perform_arm_movement",
    payload: "{"arm":"Left","position":"0","velocity":"2"}"
}
~~~

### Head ###
Move robot head to different location.  There are two different blocks to accomplish this.

![Head1](../../../assets/images/head1.png)

Parameters
* location: left, right, up, down or center
~~~json
{   type: "perform_head_movement",
    payload: "{"location":"0","velocity":5}"
}
~~~

![Head2](../../../assets/images/head2.png)

Parameters
* Axis: yaw, pitch or roll
* Position: value from -5 to 5
* Velocity: value from 0 to 10
~~~json
{   type: "set_head_position",
    payload: "{"axis":"Yaw","position":"0","velocity":"2"}"
}
~~~

### LED ###
Change LED color

![Led](../../../assets/images/led.png)

Parameters
* Color: select color from the picker
~~~json
{   type: "change_led_color",
    payload: "{"color":{"red":255,"green":0,"blue":0}}"
}
~~~

### Sensor ###
Get sensor reading in string format.  User should store reading value in a variable block.

![Sensor](../../../assets/images/sensor.png)

Parameters
* None
~~~json
{   type: "get_string_sensor_readings",
    payload: "{}"
}
~~~

### Navigation ###
Tell robot to start/stop mapping the area.  User should move robot around while doing the mapping.

![Mapping](../../../assets/images/mapping.png)

Parameters
* None
~~~json
{   type: "start_mapping",
    payload: "{}"
}

{   type: "stop_mapping",
    payload: "{}"
}
~~~

Tell robot to start/stop tracking its location in the map.

![Tracking](../../../assets/images/tracking.png)

Parameters
* None
~~~json
{   type: "start_tracking",
    payload: "{}"
}

{   type: "stop_tracking",
    payload: "{}"
}
~~~

Tell robot to follow a navigation path.

![Followpath](../../../assets/images/followpath.png)

Parameters
* Path: string of 2-D coordinates based on the map generated
~~~json
{   type: "follow_path",
    payload: "{"path":"(10,20),(20,20),(20,10)"}"
}
~~~

### Eye ###
Change the eye image being displayed on the robot.

![Eye](../../../assets/images/eye.png)

Parameters
* Eye: choose from several pre-defined eye images representing different robot's emotions (ex. tired, curious, calm etc)
~~~json
{   type: "change_eye",
    payload: "{"Valence":0.5,"Arousal":-0.5,"Dominance":-0.5}"
}
~~~

### File ###
Browse for file on your computer to upload onto the robot. Normally used with save file block after a file is selected.

![Browse](../../../assets/images/browse.png)

Parameters
* File: when click on the box, a file browse dialog is displayed to allow for file selection.  Validation of file type is also performed as we currently only allow image and audio file types to be uploaded.

### Image ###
Save image file onto the robot.

![Saveimage](../../../assets/images/saveimage.png)

Parameters
* File: save selected image file (ex. from browse file block) onto the robot.  Valid image file types are .jpg, .jpeg, .gif, .png.  Maximum file size allowed is 3MB.
~~~json
{   type: "save_image_asset_to_robot",
    payload: "{"filenameWithoutPath":test.jpg,"dataAsByteArrayString":-0.5,"widthIfImage":-0.5,"heightIfImage":"","immediatelyApply":false}"
}
~~~

### Audio ###
List existing audio files on the robot.

![Listaudio](../../../assets/images/listaudio.png)

Parameters
* File: select an existing audio file on the robot
~~~json
Request:
{   type: "update_audio_file_list", payload: "{}"
}

Response:
{
    Result: "brightlight.wav,hi__i_m_misty.wav"
}
~~~

Play audio file on the robot.

![Playaudio](../../../assets/images/playaudio.png)

Parameters
* File: connect this block to the list audio file block to play selected audio file.
~~~json
{   type: "perform_play_audio",
    payload: "{"soundName":"brightlight.wav"}"
}
~~~

Save audio file onto the robot.

![Saveaudio](../../../assets/images/saveaudio.png)

Parameters
* File: connect this block to the browse file block to first select the audio file to be saved.  The maximum file size is 3 MB.
~~~json
{   type: "save_audio_asset_to_robot",
    payload: "{"filenameWithoutPath":"hi.wav",
                "dataAsByteArrayString": "82,73,70,70,144,122,0,0,87,65,...",
                "widthIfImage":0,
                "heightIfImage":0,
                "immediatelyApply":false}"
}
~~~
